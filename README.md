# Генерация лидов из WB

Общая задача: собрать базу продавцов WB. Добавить контактную информацию по продавцам и их регион. Преобразовать к необходимому формату для загрузки в Terrasoft

В "Парсинг WB" реализован парсинг самого WB.
Пример выходного файла: Пример файла после парсинга WB
В "Добавление информации о селлерах через API СПАРК" реализовано добавление информации (регионов и контактов) из СПАРК API
В "Добавление информации о WB селлерах из Analytics_group" реализовано добавление информации из бд Analytics_group (SPARK_UL, SPARK_IP).
Пример выходного файла: Пример файла после добавления информации из Analytics_group
В "Парсинг Яндекс с Нейро (Добавление контактов селлеров WB)" реализовано добавление контактной информации через запросы к Яндекс с Нейро.
Пример выходного файла: Пример файла после добавления данных парсингом Яндекс с Нейро
В "Подготовка к заливке в terrasoft" реализована отформатировка к формату Terrasoft.
Пример выходного файла: Пример результирующего файла 

Описание парсинга WB:
    Заходим на сайт
  Вбиваем запрос
  Появляется каталог с карточками товаров
  Открываем карточку каждого товара в новой вкладке, чтобы не нужно было обратно загружать страницу каталога (это увеличивает время загрузки и приводит к ошибкам)
  Находим название продавца и проверяем есть ли оно в списке с именами продавцов текущего датафрейма или датафреймов уже сохраненных в эксельках.
  Если название продавца уже было, пропускаем его. 
    У некоторых продавцов по несколько разных названий, поэтому дубликаты все равно будут, но гораздо меньше.
    У некоторых продавцов одинаковые названия магазинов на WB, поэтому некоторые из них теряются, но таких немного, а скорость парсинга увеличивается существенно
  Если название продавца новое, открываем его карточку в новой вкладке, чтобы не прогружаться обратно.
  Собираем количество проданных товаров на WB, текущий url (чтобы была ссылка на карточку продавца)
  Кликаем на кнопку инфо и собираем официальное название и ИНН
  Закрываем карточку продавца и карточку товара и возвращаемся на страницу каталога
  Продолжаем алгоритм с другими карточками товаров

На странице как правило, 120 карточек товаров, если отрасль новая, то парсер соберет около 60 продавцов.
Со второй страницы каталога парсер находит обычно до 30 новых продавцов.
Если отрасль новая (по ней еще не собирали продавцов), можно найти прмерно 150 - 300 продавцов за час.
Если часто применять парсинг, то желательно автоматизировать навигацию по страницам каталога и охранение промежуточных результатов в эксельки (пока что вручную)


Описание парсинга с Нейро:
  Для каждой строки (официального названия) сформировать запрос ""Официальное название" контакты"
  Открыть окно браузера на странице Яндекс с Нейро
  Отправить запрос
  Дождаться полного ответа
  Забрать из него все что выделено тегом <strong> в html коде получившейся страницы
  Сохранить результат в столбце с контактами и закрыть окно браузера
  К результату применить регулярные выражения (в ответе нейро выделены не только сами контакты, но и немного текста)

1. Не очень понятно, насколько информация из яндекс с нейро достоверная
2. Практика показала, что забирать контакты лучше не через тек <strong>, навреное лучше попробовать сразу применять регулярные выражения уже над html кодом
   потому что очень много контактов теряется из-за того что нейро выдеяет не сами контакты, а слова типа "почта", "телефон"

